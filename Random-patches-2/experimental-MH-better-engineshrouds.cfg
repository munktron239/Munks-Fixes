// gives some engines from stock/dlc better shroud options, so that they can fit smaller rocket stacks better
// affected parts: mainsail, skipper, kodiak, mastodon

// to-do: find out how to give shrouds color options?
// to-do: give size0 shroud to ant engine?

// fix the shroud showing up in the mainsails preview by replacing it with one of the MH shrouds
// the exhaust dumps stick out a bit, but i think they look kind of cool
@PART[liquidEngineMainsail_v2]:HAS[@MODULE[ModulePartVariants]]:NEEDS[SquadExpansion/MakingHistory,!Restock]:FOR[MunksFixes]
{
	!mesh = DELETE	// use the MODEL {} system instead (it's much better anyways)
	MODEL
	{
		model = Squad/Parts/Engine/liquidEngineMainsail_v2/liquidEngineMainsail_v2
	}
	MODEL
	{
		model = SquadExpansion/MakingHistory/Parts/SharedAssets/Shroud1p5x3
		position = 0,0.473,0
		iconHidden = true
	}
	@MODULE[ModulePartVariants]
	{
		@VARIANT[Full]
		{
			@GAMEOBJECTS
			{
				Shroud1p5x3 = false
			}
		}
		@VARIANT[Mid]
		{
			@GAMEOBJECTS
			{
				Shroud1p5x3 = false
			}
		}
		@VARIANT[Bare]
		{
			@GAMEOBJECTS
			{
				@fairingSmall = false
				Shroud1p5x3 = true
			}
			@NODES
			{
				@node_stack_bottom = 0.0, -2.025, 0.0, 0, -1, 0, 2	// 2025, bay-bee
			}
		}
	}
	@MODULE[ModuleJettison]
	{
		@jettisonName = fairing,fairingSmall,Shroud1p5x3
	}
}

// while I'm at it, might as well give a proper 1.875m shroud to the skipper
// the fairing is just a teensy bit short, but i'm sure it's still fine
@PART[engineLargeSkipper_v2]:HAS[@MODULE[ModulePartVariants]]:NEEDS[SquadExpansion/MakingHistory,!Restock]:FOR[MunksFixes]
{
	!mesh = DELETE	// use the MODEL {} system instead (it's much better anyways)
	MODEL
	{
		model = Squad/Parts/Engine/liquidEngineSkipper_v2/skipper_v2
	}
	MODEL
	{
		model = SquadExpansion/MakingHistory/Parts/SharedAssets/Shroud1p5x2
		position = 0,0.583,0
		iconHidden = true
	}
	@MODULE[ModulePartVariants]
	{
		@VARIANT[Shroud]
		{
			@GAMEOBJECTS
			{
				Shroud1p5x2 = false
			}
		}
		@VARIANT[TrussMount]
		{
			@GAMEOBJECTS
			{
				Shroud1p5x2 = false
			}
		}
		@VARIANT[Bare]
		{
			@GAMEOBJECTS
			{
				@fairing2 = false
				Shroud1p5x2 = true
			}
			@NODES
			{
				@node_stack_bottom = 0.0, -1.292, 0.0, 0, -1, 0, 2
			}
		}
	}
	@MODULE[ModuleJettison]
	{
		@jettisonName = fairing1,fairing2,Shroud1p5x2
	}
}

// also replaces the oversized 1.875m shroud with a 1.25m shroud for the kodiak bare variant
@PART[LiquidEngineRK-7]:HAS[@MODULE[ModulePartVariants]]:NEEDS[SquadExpansion/MakingHistory,!Restock]:FOR[MunksFixes]
{
	MODEL
	{
		model = SquadExpansion/MakingHistory/Parts/SharedAssets/Shroud1x2
		position = 0,0.7,0
		iconHidden = true
	}
	@MODULE[ModulePartVariants]
	{
		@VARIANT[Bare]
		{
			@GAMEOBJECTS
			{
				@Shroud1p5x2 = false
				Shroud1x2 = true
			}
			@NODES
			{
				@node_stack_bottom = 0.0, -1.175, 0.0, 0, -1, 0, 1
			}
		}
		@VARIANT[ShroudSmall]
		{
			@GAMEOBJECTS
			{
				Shroud1x2 = false
			}
		}
		@VARIANT[ShroudBig]
		{
			@GAMEOBJECTS
			{
				Shroud1x2 = false
			}
		}
	}
	@MODULE[ModuleJettison]
	{
		@jettisonName = Shroud1p5x2,Shroud1p5x0,Shroud1x0,Shroud1x2
	}
}

// same as above, but replaces the oversized 2.5m shroud with a 1.875m one for the mastodon mid/bare variants
@PART[LiquidEngineKE-1]:HAS[@MODULE[ModulePartVariants]]:NEEDS[SquadExpansion/MakingHistory,!Restock]:FOR[MunksFixes]
{
	MODEL
	{
		model = SquadExpansion/MakingHistory/Parts/SharedAssets/Shroud1p5x3
		position = 0,0,0
		iconHidden = true
	}
	@MODULE[ModulePartVariants]
	{
		@VARIANT[Full]
		{
			@GAMEOBJECTS
			{
				Shroud1p5x3 = false
			}
		}
		@VARIANT[Mid]
		{
			@GAMEOBJECTS
			{
				@Shroud2x3 = false
				Shroud1p5x3 = true
			}
		}
		@VARIANT[Bare]
		{
			@GAMEOBJECTS
			{
				@Shroud2x2 = false
				Shroud1p5x3 = true
			}
		}
	}
	@MODULE[ModuleJettison]
	{
		@jettisonName = Shroud2x2,Shroud2x3,Shroud2x4,Shroud1p5x3
	}
}