// Gives a plume to the old Twitch, if it's not replaced by the Restock model. I'm pretty sure I'm the first person in history to make a plume for its old model!
// Has the same Hypergolic plume as the StockWaterfallEffects Twitch.
// This part was already deprecated when the Waterfall mod came out so I highly doubt anyone has ever made a plume for it.
// Fun fact: the Twitch was first added in KSP 0.18 in 2012, over 13 years ago! It got revamped in KSP 1.7 in 2019.

// Twitch: Kerolox or Hypergolic vernier
// Issues: missing random controllers: R1
// Issues: missing controllers: mach
@PART[smallRadialEngine]:HAS[!MODULE[ModuleWaterfallFX],#author[NovaSilisko]]:NEEDS[StockWaterfallEffects]:LAST[Waterfall]
{
	!EFFECTS {}
	EFFECTS
	{
		fx-twitch-old-running
		{
			AUDIO
			{
				channel = Ship
				clip = Waterfall/Sounds/EnsouSounds/Loop_Liquid_SuperLight_High
				volume = 0.0 0.0
				volume = 1.0 0.4
				pitch = 0.0 1.3
				pitch = 1.0 1.3
				loop = true
			}
		}
		engage
		{
			AUDIO
			{
				channel = Ship
				clip = Waterfall/Sounds/KW/sound_liq7
				volume = 0.4
				pitch = 1.6
				loop = false
			}
		}
		disengage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_soft
				volume = 0.4
				pitch = 2.5
				loop = false
			}
		}
		flameout
		{
			AUDIO
			{
				channel = Ship
				clip = sound_explosion_low
				volume = 0.4
				pitch = 2
				loop = false
			}
		}
	}
	@MODULE[ModuleEnginesFX]
	{
		%runningEffectName = fx-twitch-old-running
	}
	MODULE
	{
		name = ModuleWaterfallFX
		moduleID = twitchEngineOld
		CONTROLLER
		{
			name = atmosphereDepth
			linkedTo = atmosphere_density
		}
		CONTROLLER
		{
			name = throttle
			linkedTo = throttle
		}
		CONTROLLER
		{
			name = random
			linkedTo = random
			range = -1,1
		}
		TEMPLATE
		{
			name = plume
			templateName = stock-aerozine50-lower-1
			overrideParentTransform = thrustTransform
			position = 0,0.00025,0.1025
			rotation = 0, 0, 0
			scale = 0.1365, 0.1365, 0.1365
		}
		TEMPLATE
		{
			name = core
			templateName = stock-hypergolic-core
			overrideParentTransform = thrustTransform
			position = 0,0.00025,0.10275
			rotation = 0, 0, 0
			scale = 0.1365, 0.1365, 0.06825
		}
	}
	MODULE:NEEDS[B9PartSwitch]
	{
		name = ModuleB9PartSwitch
		moduleID = plumeSwitch
		switcherDescription = Plume
		switcherDescriptionPlural = Plumes
		affectDragCubes = false
		affectFARVoxels = false
		switchInFlight = true
		SUBTYPE
		{ 
			name = default
			title = Hypergolic
			primaryColor = ResourceColorMonoPropellant
			secondaryColor = Blush
			descriptionSummary = #LOC_MunksFixes_waterfall_hypergolDesc
			descriptionDetail = #LOC_MunksFixes_waterfall_defaultHypergol
		}
		SUBTYPE
		{
			name = keroloxTwitch
			title = Kerolox
			primaryColor = ResourceColorOxidizer
			secondaryColor = ResourceColorLiquidFuel
			descriptionSummary = #LOC_MunksFixes_waterfall_keroloxDesc
			descriptionDetail = #LOC_MunksFixes_waterfall_plumeKeroloxTwitchOld
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleWaterfallFX
				}
				DATA
				{
					CONTROLLER
					{
						name = atmosphereDepth
						linkedTo = atmosphere_density
					}
					CONTROLLER
					{
						name = throttle
						linkedTo = throttle
					}
					CONTROLLER
					{
						name = random
						linkedTo = random
						range = -1,1
					}
					TEMPLATE
					{
						name = plume
						templateName = stock-kerolox-vernier
						overrideParentTransform = thrustTransform
						position = 0,0.00025,0.131
						rotation = 0, 0, 0
						scale = 0.74, 0.74, 0.74
					}
					TEMPLATE
					{
						name = core
						templateName = stock-kerolox-core
						overrideParentTransform = thrustTransform
						position = 0,0.00025,0.104
						rotation = 0, 0, 0
						scale = 0.33, 0.33, 0.15
					}
				}
			}
		}
	}
}